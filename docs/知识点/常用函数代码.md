# 常用函数代码

## 防抖 debounce

```
监听一个输入框的，文字变化后触发change事件
直接用keyup 事件，则会频发触发change事件
防抖:用户输入结束或暂停时，才会触发change事件
```

```js
const input1 = document.getElementById("input1 ");
let timer = null;

// input1.addEventListener("keyup ", function () {
//   if (timer) {
//     clearTimeout(timer);
//   }
//   timer = setTimeout(() => {
//     //模拟触发change 事件
//     console.log(input1.value);
//     //清空定时器
//     timer = null;
//   }, 500);
// });

function debounce(fn, delay = 500) {
  // timer 是闭包中的
  let timer = null;
  return function () {
    if (timer) {
      clearTimeout(timer);
    }
    timer = setTimeout(() => {
      fn.apply(this, arguments);
      timer = null;
    }, delay);
  };
}

input1.addEventListener(
  "keyup",
  debounce(() => {
    console.log(input1.value);
  }),
  600
);
```

## 节流 throttle

```
拖拽一个元素时，要随时拿到该元素被拖拽的位置
直接用drag事件，则会频发触发，很容易导致卡顿
节流:无论拖拽速度多快，都会每隔100ms触发一次
```

```js
const div1 = document.getElementById("div1");

// let timer = null;
// div1.addEventListener("drag", function (e) {
//   if (timer) {
//     return;
//   }
//   timer = setTimeout(() => {
//     console.log(e.offsetx, e.offsetY);
//     timer = null;
//   }, 100);
// });

//节流

function throttle(fn, delay = 100) {
  let timer = null;
  return function () {
    if (timer) {
      return;
    }
    timer = setTimeout(() => {
      fn.apply(this, arguments);
      timer = null;
    }, delay);
  };
}
div1.addEventListener(
  "drag ",
  throttle(function (e) {
    console.log(e.offsetx, e.offsetY)
  })
);
```
